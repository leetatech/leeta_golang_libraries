<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# jwtmiddleware

```go
import "github.com/leetatech/leeta_golang_libraries/jwtmiddleware"
```

## Index

- [Variables](<#variables>)
- [func WriteJSONResponse\(w http.ResponseWriter, code int, response any\)](<#WriteJSONResponse>)
- [type Manager](<#Manager>)
  - [func New\(publicKey, privateKey string\) \(\*Manager, error\)](<#New>)
  - [func \(handler \*Manager\) ExtractUserClaims\(ctx context.Context\) \(\*UserClaims, error\)](<#Manager.ExtractUserClaims>)
  - [func \(handler \*Manager\) GenerateAuthenticationToken\(email, userID, deviceID, fcmToken string\) \(string, error\)](<#Manager.GenerateAuthenticationToken>)
  - [func \(handler \*Manager\) GenerateTokenWithExpiration\(claims \*UserClaims\) \(string, error\)](<#Manager.GenerateTokenWithExpiration>)
  - [func \(handler \*Manager\) ParseToken\(signedTokenString string\) \(\*UserClaims, error\)](<#Manager.ParseToken>)
  - [func \(handler \*Manager\) ValidateMiddleware\(next http.Handler\) http.Handler](<#Manager.ValidateMiddleware>)
  - [func \(handler \*Manager\) ValidateRestrictedAccessMiddleware\(next http.Handler\) http.Handler](<#Manager.ValidateRestrictedAccessMiddleware>)
- [type TokenManager](<#TokenManager>)
- [type UserClaims](<#UserClaims>)
  - [func \(claims \*UserClaims\) Valid\(\) error](<#UserClaims.Valid>)


## Variables

<a name="AuthenticatedUserMetadataKey"></a>

```go
var AuthenticatedUserMetadataKey = "AuthenticatedUser"
```

<a name="WriteJSONResponse"></a>
## func [WriteJSONResponse](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L257>)

```go
func WriteJSONResponse(w http.ResponseWriter, code int, response any)
```

WriteJSONResponse writes a JSON response with the given status code and response data to the HTTP response writer.

<a name="Manager"></a>
## type [Manager](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L31-L34>)

Manager handles JWT operations using RSA public and private keys.

```go
type Manager struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func [New](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L48>)

```go
func New(publicKey, privateKey string) (*Manager, error)
```

New creates a new Manager instance by parsing the provided RSA public and private keys.

<a name="Manager.ExtractUserClaims"></a>
### func \(\*Manager\) [ExtractUserClaims](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L237>)

```go
func (handler *Manager) ExtractUserClaims(ctx context.Context) (*UserClaims, error)
```

ExtractUserClaims returns claims from an authenticated user

<a name="Manager.GenerateAuthenticationToken"></a>
### func \(\*Manager\) [GenerateAuthenticationToken](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L127>)

```go
func (handler *Manager) GenerateAuthenticationToken(email, userID, deviceID, fcmToken string) (string, error)
```

GenerateAuthenticationToken sets user details and generates a signed JWT token with expiration.

<a name="Manager.GenerateTokenWithExpiration"></a>
### func \(\*Manager\) [GenerateTokenWithExpiration](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L119>)

```go
func (handler *Manager) GenerateTokenWithExpiration(claims *UserClaims) (string, error)
```

GenerateTokenWithExpiration generates a signed JWT token with a 24\-hour expiration using the provided claims.

<a name="Manager.ParseToken"></a>
### func \(\*Manager\) [ParseToken](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L154>)

```go
func (handler *Manager) ParseToken(signedTokenString string) (*UserClaims, error)
```

ParseToken parses a signed JWT string and returns the user claims if valid.

<a name="Manager.ValidateMiddleware"></a>
### func \(\*Manager\) [ValidateMiddleware](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L181>)

```go
func (handler *Manager) ValidateMiddleware(next http.Handler) http.Handler
```

ValidateMiddleware middleware required endpoints: verify claims and put claims on context

<a name="Manager.ValidateRestrictedAccessMiddleware"></a>
### func \(\*Manager\) [ValidateRestrictedAccessMiddleware](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L197>)

```go
func (handler *Manager) ValidateRestrictedAccessMiddleware(next http.Handler) http.Handler
```

ValidateRestrictedAccessMiddleware middleware required endpoints: verify claims extensively check if they have superior access to these endpoints and put claims on context

<a name="TokenManager"></a>
## type [TokenManager](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L37-L41>)

TokenManager defines the interface for JWT token parsing and user claims extraction.

```go
type TokenManager interface {
    ParseToken(signedTokenString string) (*UserClaims, error)

    ExtractUserClaims(ctx context.Context) (*UserClaims, error)
    // contains filtered or unexported methods
}
```

<a name="UserClaims"></a>
## type [UserClaims](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L22-L28>)

UserClaims represents the JWT claims for a user, including standard claims and custom fields.

```go
type UserClaims struct {
    jwt.RegisteredClaims
    UserID   string `json:"user_id"`
    DeviceID string `json:"device_id"`
    Email    string `json:"email"`
    FCMToken string `json:"fcm_token"`
}
```

<a name="UserClaims.Valid"></a>
### func \(\*UserClaims\) [Valid](<https://github.com/leetatech/leeta_golang_libraries/blob/main/jwtmiddleware/middleware.go#L138>)

```go
func (claims *UserClaims) Valid() error
```

Valid checks if the token's claims are still valid \(not expired\).

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
